import numpy as np
from scipy.integrate import odeint
def multisite_1_to_5(a,x,kd1,kd2,kd3,kd4,kd5):
	def ode_multisite_1_to_5(concs, t, kd1,kd2,kd3,kd4,kd5):
		a,x,a1_x,a2_x,a3_x,a4_x,a5_x,a1_2_x,a1_3_x,a1_4_x,a1_5_x,a2_3_x,a2_4_x,a2_5_x,a3_4_x,a3_5_x,a4_5_x,a1_2_3_x,a1_2_4_x,a1_2_5_x,a1_3_4_x,a1_3_5_x,a1_4_5_x,a2_3_4_x,a2_3_5_x,a2_4_5_x,a3_4_5_x,a1_2_3_4_x,a1_2_3_5_x,a1_2_4_5_x,a1_3_4_5_x,a2_3_4_5_x,a1_2_3_4_5_x=concs
		r1 = -a*x + kd1*a1_x
		r2 = -a*x + kd2*a2_x
		r3 = -a*x + kd3*a3_x
		r4 = -a*x + kd4*a4_x
		r5 = -a*x + kd5*a5_x
		r6 = -a1_x*x + kd2*a1_2_x
		r7 = -a2_x*x + kd1*a1_2_x
		r8 = -a1_x*x + kd3*a1_3_x
		r9 = -a3_x*x + kd1*a1_3_x
		r10 = -a1_x*x + kd4*a1_4_x
		r11 = -a4_x*x + kd1*a1_4_x
		r12 = -a1_x*x + kd5*a1_5_x
		r13 = -a5_x*x + kd1*a1_5_x
		r14 = -a2_x*x + kd3*a2_3_x
		r15 = -a3_x*x + kd2*a2_3_x
		r16 = -a2_x*x + kd4*a2_4_x
		r17 = -a4_x*x + kd2*a2_4_x
		r18 = -a2_x*x + kd5*a2_5_x
		r19 = -a5_x*x + kd2*a2_5_x
		r20 = -a3_x*x + kd4*a3_4_x
		r21 = -a4_x*x + kd3*a3_4_x
		r22 = -a3_x*x + kd5*a3_5_x
		r23 = -a5_x*x + kd3*a3_5_x
		r24 = -a4_x*x + kd5*a4_5_x
		r25 = -a5_x*x + kd4*a4_5_x
		r26 = -a1_2_x*x + kd3*a1_2_3_x
		r27 = -a1_3_x*x + kd2*a1_2_3_x
		r28 = -a2_3_x*x + kd1*a1_2_3_x
		r29 = -a1_2_x*x + kd4*a1_2_4_x
		r30 = -a1_4_x*x + kd2*a1_2_4_x
		r31 = -a2_4_x*x + kd1*a1_2_4_x
		r32 = -a1_2_x*x + kd5*a1_2_5_x
		r33 = -a1_5_x*x + kd2*a1_2_5_x
		r34 = -a2_5_x*x + kd1*a1_2_5_x
		r35 = -a1_3_x*x + kd4*a1_3_4_x
		r36 = -a1_4_x*x + kd3*a1_3_4_x
		r37 = -a3_4_x*x + kd1*a1_3_4_x
		r38 = -a1_3_x*x + kd5*a1_3_5_x
		r39 = -a1_5_x*x + kd3*a1_3_5_x
		r40 = -a3_5_x*x + kd1*a1_3_5_x
		r41 = -a1_4_x*x + kd5*a1_4_5_x
		r42 = -a1_5_x*x + kd4*a1_4_5_x
		r43 = -a4_5_x*x + kd1*a1_4_5_x
		r44 = -a2_3_x*x + kd4*a2_3_4_x
		r45 = -a2_4_x*x + kd3*a2_3_4_x
		r46 = -a3_4_x*x + kd2*a2_3_4_x
		r47 = -a2_3_x*x + kd5*a2_3_5_x
		r48 = -a2_5_x*x + kd3*a2_3_5_x
		r49 = -a3_5_x*x + kd2*a2_3_5_x
		r50 = -a2_4_x*x + kd5*a2_4_5_x
		r51 = -a2_5_x*x + kd4*a2_4_5_x
		r52 = -a4_5_x*x + kd2*a2_4_5_x
		r53 = -a3_4_x*x + kd5*a3_4_5_x
		r54 = -a3_5_x*x + kd4*a3_4_5_x
		r55 = -a4_5_x*x + kd3*a3_4_5_x
		r56 = -a1_2_3_x*x + kd4*a1_2_3_4_x
		r57 = -a1_2_4_x*x + kd3*a1_2_3_4_x
		r58 = -a1_3_4_x*x + kd2*a1_2_3_4_x
		r59 = -a2_3_4_x*x + kd1*a1_2_3_4_x
		r60 = -a1_2_3_x*x + kd5*a1_2_3_5_x
		r61 = -a1_2_5_x*x + kd3*a1_2_3_5_x
		r62 = -a1_3_5_x*x + kd2*a1_2_3_5_x
		r63 = -a2_3_5_x*x + kd1*a1_2_3_5_x
		r64 = -a1_2_4_x*x + kd5*a1_2_4_5_x
		r65 = -a1_2_5_x*x + kd4*a1_2_4_5_x
		r66 = -a1_4_5_x*x + kd2*a1_2_4_5_x
		r67 = -a2_4_5_x*x + kd1*a1_2_4_5_x
		r68 = -a1_3_4_x*x + kd5*a1_3_4_5_x
		r69 = -a1_3_5_x*x + kd4*a1_3_4_5_x
		r70 = -a1_4_5_x*x + kd3*a1_3_4_5_x
		r71 = -a3_4_5_x*x + kd1*a1_3_4_5_x
		r72 = -a2_3_4_x*x + kd5*a2_3_4_5_x
		r73 = -a2_3_5_x*x + kd4*a2_3_4_5_x
		r74 = -a2_4_5_x*x + kd3*a2_3_4_5_x
		r75 = -a3_4_5_x*x + kd2*a2_3_4_5_x
		r76 = -a1_2_3_4_x*x + kd5*a1_2_3_4_5_x
		r77 = -a1_2_3_5_x*x + kd4*a1_2_3_4_5_x
		r78 = -a1_2_4_5_x*x + kd3*a1_2_3_4_5_x
		r79 = -a1_3_4_5_x*x + kd2*a1_2_3_4_5_x
		r80 = -a2_3_4_5_x*x + kd1*a1_2_3_4_5_x
		dadt = 0.0 +r1 +r2 +r3 +r4 +r5 
		da1_xdt = 0.0 -r1 +r6 +r8 +r10 +r12 
		da2_xdt = 0.0 -r2 +r7 +r14 +r16 +r18 
		da3_xdt = 0.0 -r3 +r9 +r15 +r20 +r22 
		da4_xdt = 0.0 -r4 +r11 +r17 +r21 +r24 
		da5_xdt = 0.0 -r5 +r13 +r19 +r23 +r25 
		da1_2_xdt = 0.0 -r6 -r7 +r26 +r29 +r32 
		da1_3_xdt = 0.0 -r8 -r9 +r27 +r35 +r38 
		da1_4_xdt = 0.0 -r10 -r11 +r30 +r36 +r41 
		da1_5_xdt = 0.0 -r12 -r13 +r33 +r39 +r42 
		da2_3_xdt = 0.0 -r14 -r15 +r28 +r44 +r47 
		da2_4_xdt = 0.0 -r16 -r17 +r31 +r45 +r50 
		da2_5_xdt = 0.0 -r18 -r19 +r34 +r48 +r51 
		da3_4_xdt = 0.0 -r20 -r21 +r37 +r46 +r53 
		da3_5_xdt = 0.0 -r22 -r23 +r40 +r49 +r54 
		da4_5_xdt = 0.0 -r24 -r25 +r43 +r52 +r55 
		da1_2_3_xdt = 0.0 -r26 -r27 -r28 +r56 +r60 
		da1_2_4_xdt = 0.0 -r29 -r30 -r31 +r57 +r64 
		da1_2_5_xdt = 0.0 -r32 -r33 -r34 +r61 +r65 
		da1_3_4_xdt = 0.0 -r35 -r36 -r37 +r58 +r68 
		da1_3_5_xdt = 0.0 -r38 -r39 -r40 +r62 +r69 
		da1_4_5_xdt = 0.0 -r41 -r42 -r43 +r66 +r70 
		da2_3_4_xdt = 0.0 -r44 -r45 -r46 +r59 +r72 
		da2_3_5_xdt = 0.0 -r47 -r48 -r49 +r63 +r73 
		da2_4_5_xdt = 0.0 -r50 -r51 -r52 +r67 +r74 
		da3_4_5_xdt = 0.0 -r53 -r54 -r55 +r71 +r75 
		da1_2_3_4_xdt = 0.0 -r56 -r57 -r58 -r59 +r76 
		da1_2_3_5_xdt = 0.0 -r60 -r61 -r62 -r63 +r77 
		da1_2_4_5_xdt = 0.0 -r64 -r65 -r66 -r67 +r78 
		da1_3_4_5_xdt = 0.0 -r68 -r69 -r70 -r71 +r79 
		da2_3_4_5_xdt = 0.0 -r72 -r73 -r74 -r75 +r80 
		da1_2_3_4_5_xdt = 0.0 -r76 -r77 -r78 -r79 -r80 
		dxdt = r1+r2+r3+r4+r5+r6+r7+r8+r9+r10+r11+r12+r13+r14+r15+r16+r17+r18+r19+r20+r21+r22+r23+r24+r25+r26+r27+r28+r29+r30+r31+r32+r33+r34+r35+r36+r37+r38+r39+r40+r41+r42+r43+r44+r45+r46+r47+r48+r49+r50+r51+r52+r53+r54+r55+r56+r57+r58+r59+r60+r61+r62+r63+r64+r65+r66+r67+r68+r69+r70+r71+r72+r73+r74+r75+r76+r77+r78+r79+r80
		return [dadt, dxdt, da1_xdt, da2_xdt, da3_xdt, da4_xdt, da5_xdt, da1_2_xdt, da1_3_xdt, da1_4_xdt, da1_5_xdt, da2_3_xdt, da2_4_xdt, da2_5_xdt, da3_4_xdt, da3_5_xdt, da4_5_xdt, da1_2_3_xdt, da1_2_4_xdt, da1_2_5_xdt, da1_3_4_xdt, da1_3_5_xdt, da1_4_5_xdt, da2_3_4_xdt, da2_3_5_xdt, da2_4_5_xdt, da3_4_5_xdt, da1_2_3_4_xdt, da1_2_3_5_xdt, da1_2_4_5_xdt, da1_3_4_5_xdt, da2_3_4_5_xdt, da1_2_3_4_5_xdt]
	res = odeint(ode_multisite_1_to_5, [a, x, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0], np.linspace(0, 10, 1000), args=(kd1,kd2,kd3,kd4,kd5))[-1]
	return (1*(sum(res[2:7]))+2*(sum(res[7:17]))+3*(sum(res[17:27]))+4*(sum(res[27:32]))+5*res[32])/x
